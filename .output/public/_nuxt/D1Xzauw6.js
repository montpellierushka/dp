import x from"./C1Mbe6zW.js";import{C,r as d,c as r,a as o,n as f,j as a,b as y,q as j,t as B,o as i}from"./DKez8kYg.js";const N=window.setInterval,P={class:"space-y-4"},R={key:0,class:"relative"},U=["src"],G={key:2,class:"w-full bg-gray-200 rounded-full h-2.5"},F={key:3,class:"text-red-500 text-sm"},D=C({__name:"RecipeImageUpload",props:{initialImage:{}},emits:["image-uploaded"],setup(L,{emit:_}){const p=_,u=d(null),c=d(""),s=d(0),l=d(""),h=()=>{var t;(t=u.value)==null||t.click()},b=t=>{var m;const e=(m=t.target.files)==null?void 0:m[0];if(!e)return;if(!e.type||typeof e.type!="string"){l.value="Не удалось определить тип файла";return}if(!["image/jpeg","image/png"].includes(e.type)){l.value="Поддерживаются только форматы JPG и PNG";return}if(e.size>5*1024*1024){l.value="Размер файла не должен превышать 5MB";return}const g=new FileReader;g.onload=k=>{var v;c.value=(v=k.target)==null?void 0:v.result},g.readAsDataURL(e),s.value=0,l.value=null;const I=N(()=>{s.value+=10,s.value>=100&&(clearInterval(I),setTimeout(()=>{p("image-uploaded",URL.createObjectURL(e))},500))},200)},w=()=>{c.value="",u.value&&(u.value.value=""),p("image-uploaded","")};return(t,n)=>{const e=x;return i(),r("div",P,[a(c)||t.initialImage?(i(),r("div",R,[o("img",{src:a(c)||t.initialImage,alt:"Предпросмотр",class:"w-full h-64 object-cover rounded-lg"},null,8,U),o("button",{onClick:w,class:"absolute top-2 right-2 p-2 bg-white/80 hover:bg-white rounded-full transition-colors"},[y(e,{name:"trash",class:"w-5 h-5 text-red-500"})])])):(i(),r("div",{key:1,class:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center cursor-pointer hover:border-blue-500 transition-colors",onClick:h},[y(e,{name:"plus",class:"w-12 h-12 text-gray-400 mx-auto mb-4"}),n[0]||(n[0]=o("p",{class:"text-gray-500"},"Нажмите для загрузки изображения",-1)),n[1]||(n[1]=o("p",{class:"text-sm text-gray-400 mt-2"},"Поддерживаются форматы JPG и PNG, до 5MB",-1))])),o("input",{ref_key:"fileInput",ref:u,type:"file",accept:"image/jpeg,image/png",class:"hidden",onChange:b},null,544),a(s)>0&&a(s)<100?(i(),r("div",G,[o("div",{class:"bg-blue-500 h-2.5 rounded-full transition-all duration-300",style:j({width:`${a(s)}%`})},null,4)])):f("",!0),a(l)?(i(),r("div",F,B(a(l)),1)):f("",!0)])}}});export{D as _};
